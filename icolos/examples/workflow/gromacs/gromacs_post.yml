workflow:
  header:
    description: full md run with gromacs
    environment:
      export:
      - key: GMX_GPU_DD_COMMS
        value: 'true'
      - key: GMX_GPU_PME_PP_COMMS
        value: 'true'
      - key: GMX_FORCE_UPDATE_DEFAULT_GPU
        value: 'true'
    global_variables:


    version: 1.9.0
    workflow_id: gromacs_test
  steps:
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      generic:
      - extension: pdb
        source: '{file_base}/1BVG.pdb'
    settings:
      additional: {}
      arguments:
        flags:
        - -ignh
        parameters:
          -ff: amber03
          -water: tip3p
    step_id: 01_pdb2gmx
    type: pdb2gmx
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      gmx_state:
        source: 01_pdb2gmx
    settings:
      additional: {}
      arguments:
        flags:
        - -c
        parameters:
          -bt: dodecahedron
          -d: '1.0'
    step_id: 02_editconf
    type: editconf
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      gmx_state:
        source: 02_editconf
    settings:
      additional: {}
      arguments:
        flags: []
        parameters:
          -cs: spc216
    step_id: 03_solvate
    type: solvate
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      generic:
      - extension: mdp
        source: '{file_base}/ions.mdp'
      gmx_state:
        source: 03_solvate
    settings:
      additional:
        restraints: false
      arguments:
        flags: []
        parameters: {}
    step_id: 04_grompp
    type: grompp
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      gmx_state:
        source: 04_grompp
    settings:
      additional:
        pipe_input: SOL
      arguments:
        flags:
        - -neutral
        parameters:
          -nname: CL
          -pname: NA
    step_id: 05_genion
    type: genion
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      generic:
      - extension: mdp
        source: '{file_base}/minim.mdp'
      gmx_state:
        source: 05_genion
    settings:
      additional:
        restraints: false
      arguments:
        flags: []
        parameters: {}
    step_id: 06_grompp_eminim
    type: grompp
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      gmx_state:
        source: 06_grompp_eminim
    settings:
      additional: {}
      arguments:
        flags: []
        parameters: {}
    step_id: 07_eminim_mdrun
    type: mdrun
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      generic:
      - extension: mdp
        source: '{file_base}/nvt_equil.mdp'
      gmx_state:
        source: 07_eminim_mdrun
    settings:
      additional:
        make_ndx_command: auto
        restraints: true
      arguments:
        flags: []
        parameters:
          -n: index.ndx
    step_id: 08_nvt_grompp
    type: grompp
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      gmx_state:
        source: 08_nvt_grompp
    settings:
      additional: {}
      arguments:
        flags: []
        parameters: {}
    step_id: 09_nvt_mdrun
    type: mdrun
  - execution:
      prefix_execution: module load GROMACS/2021-fosscuda-2019a-PLUMED-2.7.1-Python-3.7.2
        && unset PYTHONPATH
    input:
      gmx_state:
        source: 09_nvt_mdrun
    settings:
      additional:
        script_path: <FILL_PATH>/script.sh
        structure_flag: -s
        trajectory_flag: -f
      arguments:
        flags: []
        parameters:
          -dt: '2'
    step_id: 10_post
    type: post_process
    writeout:
    - destination:
        resource: '{output_dir}/gyr.xvg'
      generic:
        key: xvg
